-- CREATE TABLE STATEMENT
-- MOVED TO BEING A VIEW INSTEAD OF A TABLE

CREATE OR REPLACE TABLE TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS ( PTS TIMESTAMP_NTZ NOT NULL COMMENT 'POSTING DATE & TIME AS YYYYMMDD-HHMMSS', REC_TYPE VARCHAR(3) NOT NULL COMMENT 'FIN', YEAR NUMBER(4,0) NOT NULL COMMENT 'YEAR OF THE QUARTER END', QUARTER NUMBER(1,0) NOT NULL COMMENT 'QUARTER NUMBER: VALID VALUES ARE 1, 2, 3, 4', QTR_START_DATE DATE NOT NULL COMMENT 'START DATE OF QUARTER, AS YYYYMMDD', POSTING_DATE DATE NOT NULL COMMENT 'POSTING DATE OF QUARTERLY REPORT AS YYYYMMDD', REVENUE NUMBER(15,2) NOT NULL COMMENT 'REPORTED REVENUE FOR THE QUARTER', EARNINGS NUMBER(15,2) NOT NULL COMMENT 'NET EARNINGS REPORTED FOR THE QUARTER', EPS NUMBER(10,2) NOT NULL COMMENT 'BASIC EARNINGS PER SHARE FOR THE QUARTER', DILUTED_EPS NUMBER(10,2) NOT NULL COMMENT 'DILUTED EARNINGS PER SHARE FOR THE QUARTER', MARGIN NUMBER(10,2) NOT NULL COMMENT 'PROFIT DIVIDED BY REVENUES FOR THE QUARTER', INVENTORY NUMBER(15,2) NOT NULL COMMENT 'VALUE OF INVENTORY ON HAND AT END OF QUARTER', ASSETS NUMBER(15,2) NOT NULL COMMENT 'VALUE OF TOTAL ASSETS AT THE END OF QUARTER', LIABILITIES NUMBER(15,2) NOT NULL COMMENT 'VALUE OF TOTAL LIABILITIES AT THE END OF QUARTER', SH_OUT NUMBER(13,0) NOT NULL COMMENT 'AVERAGE NUMBER OF SHARES OUTSTANDING', DILUTED_SH_OUT NUMBER(13,0) NOT NULL COMMENT 'AVERAGE NUMBER OF SHARES OUTSTANDING (DILUTED)', CO_NAME_OR_CIK VARCHAR(60) NOT NULL COMMENT 'COMPANY CIK NUMBER (IF ONLY DIGITS, 10 VARCHARS) OR NAME (IF NOT ONLY DIGITS, 60 VARCHARS)', LAST_UPDATED_TS TIMESTAMP_LTZ NOT NULL COMMENT 'LAST TIME THIS RECORD WAS INSERTED OR UPDATED' ) ;

-- CREATE STREAM STATEMENT

CREATE OR REPLACE STREAM TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS_STM ON TABLE TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS
;

-- CREATE SEQUENCE STATEMENT

CREATE SEQUENCE IF NOT EXISTS TPCDI_WH.PUBLIC.DIM_ACCOUNT_SEQ   START WITH = 1   INCREMENT = 1   COMMENT = 'DATABASE SEQUENCE TO SOURCE THE SURROGATE KEY FOR ACCOUNT.' ; 

-- CREATE TABLE STATEMENT

CREATE OR REPLACE TABLE TPCDI_WH.PUBLIC.DIM_ACCOUNT ( SK_ACCOUNT_ID NUMBER(11) NOT NULL COMMENT 'SURROGATE KEY FOR ACCOUNTID', ACCOUNT_ID NUMBER(11) NOT NULL COMMENT 'CUSTOMER ACCOUNT IDENTIFIER', SK_BROKER_ID NUMBER(11) NOT NULL COMMENT 'SURROGATE KEY OF MANAGING BROKER', SK_CUSTOMER_ID NUMBER(11) NOT NULL COMMENT 'SURROGATE KEY OF CUSTOMER', STATUS CHAR(10) NOT NULL COMMENT 'ACCOUNT STATUS, ACTIVE OR CLOSED', ACCOUNT_DESC CHAR(50) COMMENT 'NAME OF CUSTOMER ACCOUNT', TAX_STATUS NUMBER(1) COMMENT '0, 1 OR 2 TAX STATUS OF THIS ACCOUNT', BATCH_ID NUMBER(5) NOT NULL COMMENT 'BATCH ID WHEN THIS RECORD WAS INSERTED', INSERTED_TS TIMESTAMP_LTZ NOT NULL COMMENT 'TIMESTAMP WHEN THIS RECORD WAS INSERTED' ) ;

CREATE OR REPLACE VIEW TPCDI_STG.PUBLIC.FINWIRE_FIN_STG AS
SELECT
    TO_TIMESTAMP_NTZ(PTS,'YYYYMMDD-HH24MISS') AS PTS,
    REC_TYPE,
    TO_NUMBER(YEAR,4,0) AS YEAR,
    TO_NUMBER(QUARTER,1,0) AS QUARTER,
    TO_DATE(QTR_START_DATE, 'YYYYMMDD') AS QTR_START_DATE,
    TO_DATE(POSTING_DATE, 'YYYYMMDD') AS POSTING_DATE,
    TO_NUMBER(REVENUE,15,2) AS REVENUE,
    TO_NUMBER(EARNINGS,15,2) AS EARNINGS,
    TO_NUMBER(EPS,10,2) AS EPS,
    TO_NUMBER(DILUTED_EPS,10,2) AS DILUTED_EPS,
    TO_NUMBER(MARGIN,10,2) AS MARGIN,
    TO_NUMBER(INVENTORY,15,2) AS INVENTORY,
    TO_NUMBER(ASSETS,15,2) AS ASSETS,
    TO_NUMBER(LIABILITIES,15,2) AS LIABILITIES,
    TO_NUMBER(SH_OUT,13,0) AS SH_OUT,
    TO_NUMBER(DILUTED_SH_OUT,13,0) AS DILUTED_SH_OUT,
    CO_NAME_OR_CIK 
FROM TPCDI_STG.PUBLIC.FINWIRE_STG
WHERE REC_TYPE = 'FIN'
; 
CREATE OR REPLACE TASK TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS_TSK
  WAREHOUSE = TASK_WH,
  SCHEDULE = '1 MINUTE'
AS
INSERT INTO TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS
  SELECT
        TO_TIMESTAMP_NTZ(PTS,'YYYYMMDD-HH24MISS')
      , REC_TYPE
      , TO_NUMBER(YEAR,4,0)
      , TO_NUMBER(QUARTER,1,0)
      , TO_DATE(QTR_START_DATE, 'YYYYMMDD')
      , TO_DATE(POSTING_DATE, 'YYYYMMDD')
      , TO_NUMBER(REVENUE,15,2)
      , TO_NUMBER(EARNINGS,15,2)
      , TO_NUMBER(EPS,10,2)
      , TO_NUMBER(DILUTED_EPS,10,2)
      , TO_NUMBER(MARGIN,10,2)
      , TO_NUMBER(INVENTORY,15,2)
      , TO_NUMBER(ASSETS,15,2)
      , TO_NUMBER(LIABILITIES,15,2)
      , TO_NUMBER(SH_OUT,13,0)
      , TO_NUMBER(DILUTED_SH_OUT,13,0)
      , CO_NAME_OR_CIK
      , CURRENT_TIMESTAMP()
  FROM TPCDI_STG.PUBLIC.FINWIRE_STG_FIN_STM
  WHERE REC_TYPE = 'FIN'
;

ALTER TASK TPCDI_ODS.PUBLIC.FINWIRE_FIN_ODS_TSK RESUME;
